{
    "contents" : "---\ntitle: 'Reproducible Research: Peer Assessment 1'\nauthor: \"by jmvilaverde\"\noutput:\n  html_document:\n    keep_md: yes\n    pandoc_args:\n    - +RTS\n    - -K64m\n    - -RTS\n---\n\n\n## 1. Loading and preprocessing the data\n\n#### Code:\n```{r loadingData, echo=TRUE}\n##Load the data\n#Zip file is always present into project directory\ndataZipFile <- \"activity.zip\"\ndataFile <- \"activity.csv\"\n\n#Check if exists unzipped, else unzip it\nif(!file.exists(dataFile)) unzip(dataFile)\n\n#Read file\nbasedata <- read.csv(dataFile, sep = \",\")\n\n##Process data\n#Remove NAs\ndata <- basedata[!is.na(basedata$steps),]\n```\n\n***\n\n## 2. What is mean total number of steps taken per day?\n\n### Calculate total number of steps taken per day\n\n#### Code:\n\n```{r calculateTotalSteps, echo=TRUE}\n#Use of dplyr library\nlibrary(dplyr)\n\n#Calculate Total Steps per day\n#Use dataset data without NAs\ndataStepsSum <- with(data, aggregate(steps, list(date), sum))\ndataStepsSum <- rename(dataStepsSum, date = Group.1, steps = x)\ndataStepsSum <- select(dataStepsSum, steps, date)\n```\n\n### Histogram of the total number of steps taken each day\n\n#### Code:\n\n```{r histTotalSteps, echo=TRUE}\n#Generate graph\nhist(dataStepsSum$steps, breaks = nrow(dataStepsSum), main = \"Histrogram of Total number of Steps per Day\", xlab = \"Total Steps\")\n```\n\n\n### Calculate and report the mean and median of the total number of steps taken per day\n\n#### Code:\n\n```{r meanMedianTotalSteps, echo=TRUE}\n#Calculate mean and median rounded to 2 decimals\nmeanSteps <- round(mean(dataStepsSum$steps),2)\nmedianSteps <- round(median(dataStepsSum$steps),2)\n```\n\n> Values of mean and median for data without NAs\n> \n.      | values\n------ | -----------------------------\nmean   | `r as.character(meanSteps)`\nmedian | `r as.character(medianSteps)`\n\n***\n\n## 3. What is the average daily activity pattern?\n\n### Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)\n\n#### Code:\n\n```{r averageDailyCalculateAndGraph, echo = TRUE}\n#Use ggplot2 library\nlibrary(ggplot2)\n\n#Calculate average number of steps per 5-minute interval\ndataIntervalAverage <- with(data, aggregate(steps, list(interval), mean))\ndataIntervalAverage <- rename(dataIntervalAverage, interval = Group.1, steps = x)\n\n#Make plot\nwith(dataIntervalAverage, qplot(x = interval, y = steps, geom = \"line\", main = \"Average of steps taken by 5-minute interval\", xlab = \"5-minute interval\", ylab = \"Average steps\"))\n```\n\n### Calculate 5-minute interval that contains the maximum number of steps on average across all the days.\n\n#### Code:\n\n```{r averageDailyMax, echo=TRUE}\n#Calculate maximum number of steps interval\nmaxIntervalAverage <- dataIntervalAverage[dataIntervalAverage$steps == max(dataIntervalAverage$steps),]\n```\n\n> The maximum average interval of 5-minutes interval is `r maxIntervalAverage[1]` with an average of `r round(maxIntervalAverage[2],2)` steps.\n\n***\n\n## 4. Imputing missing values\n\n### Calculate and report the total number of missing values in the dataset\n\n#### Code:\n\n```{r imputingMissingValuesTotal, echo = TRUE}\n#Calculate total number of missing values\nnaRows <- nrow(basedata[is.na(basedata),])\n```\n\n> Total number of rows with missing values is `r naRows`\n\n### Devise a strategy for filling in all of the missing values in the dataset. \n\n> As strategy for filling in all of the missin values I'm going to use the mean of steps for that 5-minute interval.\n\n\n### Create a new dataset that is equal to the original dataset but with the missing data filled in.\n\n#### Code:\n\n```{r imputingMissingValuesDataset, echo = TRUE}\n#Create a new dataset that is equal to the original dataset but with the missing data filled in.\n#Is used dataset basedata, this dataset is the original that contains NAs.\n#The NAs values are replaced with the mean of this interval contained in dataset dataIntervalAverage\n\nbasedata %>% \ninner_join(dataIntervalAverage, by = \"interval\") %>%\nmutate(steps = ifelse(is.na(steps.x), steps.y, steps.x)) %>%\nselect(steps, date, interval) -> dataTreated\n\n#Calculate Total Steps per day\ndataStepsSumTreated <- with(dataTreated, aggregate(steps, list(date), sum))\ndataStepsSumTreated <- rename(dataStepsSumTreated, date = Group.1, steps = x)\ndataStepsSumTreated <- select(dataStepsSumTreated, steps, date)\n```\n\n### Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. \n\n#### Code:\n\n```{r imputingMissingValuesHist, echo=TRUE}\n#Generate histogram\nhist(dataStepsSumTreated$steps, breaks = nrow(dataStepsSumTreated), main = \"Histrogram of Total Steps per Day with NAs filled - Frequency\", xlab = \"Total Steps\")\n```\n\n#### Code:\n\n```{r imputingMissingValuesMeanMedian, echo=TRUE}\n#Calculate mean and median rounded to 2 decimals\nmeanStepsTreated <- round(mean(dataStepsSumTreated$steps),2)\nmedianStepsTreated <- round(median(dataStepsSumTreated$steps),2)\n```\n\n> Comparative of mean and median for data with and without NAs\n> \nvalues | data with NA                  | data without NA                      | difference\n------ | ----------------------------- | ------------------------------------ | ------------------------------------------------\nmean   | `r as.character(meanSteps)`   | `r as.character(meanStepsTreated)`   | `r as.character(meanSteps-meanStepsTreated)`\nmedian | `r as.character(medianSteps)` | `r as.character(medianStepsTreated)` | `r as.character(medianSteps-medianStepsTreated)`\n\n#### Do these values differ from the estimates from the first part of the assignment? \n\n> Yes, it differ from the estimates.\n\n#### What is the impact of imputing missing data on the estimates of the total daily number of steps?\n\n> The mean remains the same, but the median is bigger without missing data.\n\n***\n\n## 5. Are there differences in activity patterns between weekdays and weekends?\n\n### Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.\n\n#### Code:\n\n```{r differencesNewFactor, echo = TRUE}\nlibrary(lubridate)\n\ngetTypeOfDay <- function(x) {ifelse(x %in% c(7,1),\"Weekends\", \"Weekdays\")}\n\ndata %>%\n        mutate(wdays = wday(ymd(date))) %>% \n        mutate(typeOfDay = as.factor(getTypeOfDay(wdays))) %>%\n        select(steps, date, interval, typeOfDay) -> dataDays\n\ndataDaysAverage <- with(dataDays, aggregate(steps, list(interval, typeOfDay), mean))\ndataDaysAverage <- rename(dataDaysAverage, interval = Group.1, typeOfDay = Group.2, steps = x)\n```\n\n### Make a panel plot containing a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis).\n\n#### Code:\n\n```{r differencesHist, echo = TRUE}\ng <- ggplot(dataDaysAverage, aes(interval, steps)) \ng <- g + geom_line(col=\"blue\") + facet_wrap(~typeOfDay)\ng <- g + ggtitle(\"Comparative of activity patterns between weekdays and weekends\")\ng <- g + xlab(\"5-minute interval\") + ylab(\"Total steps\")\ng\n```\n\n",
    "created" : 1433869906053.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "6608890",
    "id" : "DEE23CB6",
    "lastKnownWriteTime" : 1434029647,
    "path" : "D:/Privado/repos/5.ReproducibleResearch/PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}